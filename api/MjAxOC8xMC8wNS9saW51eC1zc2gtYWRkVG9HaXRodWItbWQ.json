{"title":"linux下误将ssh密钥写入/root","date":"2018-10-05T04:05:37.000Z","date_formatted":{"ll":"Oct 5, 2018","L":"10/05/2018","MM-DD":"10-05"},"link":"2018/10/05/linux-ssh-addToGithub-md","tags":["github","linux","ssh协议"],"categories":["linux"],"updated":"2018-10-08T03:52:11.000Z","content":"<p>无论是使用github类似的开源平台还是搭建的git服务器来团队协作开发，我们总是需要使用本地ssh密钥来建立连接，如果要使用ssh服务linux下我们还需要通过终端安装ssh并且开启ssh服务</p>\n<a id=\"more\"></a>\n\n<h1 id=\"一-关于ssh密钥\">一.关于ssh密钥<a href=\"2018/10/05/linux-ssh-addToGithub-md#一-关于ssh密钥\"></a></h1><p>首先应该检查下是否存在ssh密钥，<br>终端键入<code>ls -ah</code>查看是否存在.ssh文件，不存在则我们需要生成ssh密钥：<br>终端键入<code>ssh-keygen -t rsa -C &#39;you_email@email.com&#39;</code></p>\n<p>回车之后下面是设置的密码，不设置回车即可。即：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"code\"><pre><span class=\"line\">Enter <span class=\"built_in\">file</span> <span class=\"keyword\">in</span> which <span class=\"built_in\">to</span> save <span class=\"keyword\">the</span> key (/home/.ssh/id_rsa): 【按回车】</span><br><span class=\"line\"><span class=\"comment\">/*这一步不需要修改名字，否则后面我们通过`ssh -T git@github.com`检测是否建立连接会失败，因为ssh默认会读取id_rsa这个公钥*/</span></span><br><span class=\"line\">Enter passphrase (<span class=\"literal\">empty</span> <span class=\"keyword\">for</span> no passphrase): 【输入密码】</span><br><span class=\"line\">Enter same passphrase again: 【再次输入密码】</span><br></pre></td></tr></table></div></figure>\n<p>然后将.ssh/id_rsa.pub添加进去你github中ssh中即可</p>\n<p>通过<code>sss -T git@github.com</code>检查连接是否建立成功，出现下面信息则提示已经建立连接喽</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"code\"><pre><span class=\"line\">Hi username! You<span class=\"symbol\">'ve</span> successfully authenticated, but GitHub does <span class=\"keyword\">not</span> provide shell <span class=\"keyword\">access</span>.</span><br></pre></td></tr></table></div></figure>\n<p>然后回去观察你的github ssh and GpG keys的对应的ssh小钥匙灰色已经变成了绿色</p>\n<h1 id=\"二-关于ssh服务\">二.关于ssh服务<a href=\"2018/10/05/linux-ssh-addToGithub-md#二-关于ssh服务\"></a></h1><p>对于linux下安装ssh服务相关，这里我做了简单的整理：</p>\n<h3 id=\"1-查看ssh服务的状态\">1.查看ssh服务的状态<a href=\"2018/10/05/linux-ssh-addToGithub-md#1-查看ssh服务的状态\"></a></h3><p>输入<code>sudo service sshd status</code>:<br>如果出现No such file or directory相关提示，说明还没有安装ssh服务<br>如果提示Active:inactive(dead)，则已经安装了ssh服务，但是没有开启</p>\n<h3 id=\"2-安装ssh服务\">2.安装ssh服务<a href=\"2018/10/05/linux-ssh-addToGithub-md#2-安装ssh服务\"></a></h3><p>因为linux发行版众多，有一些不同的安装方式<br>redhat，fedora，centos等系列linux发行版可以尝试：<br><code>sudo yum install sshd</code>或者<code>sudo yum install openssh-server</code><br>debian，ubuntu，linux mint等系列的linux发行版尝试：<br><code>sudo apt-get install sshd</code>或者<code>sudo apt-get install openssh-server</code></p>\n<h3 id=\"3-开启ssh服务\">3.开启ssh服务<a href=\"2018/10/05/linux-ssh-addToGithub-md#3-开启ssh服务\"></a></h3><p>在终端输入<code>sudo service sshd start</code><br>提示Active: active (running) since Sun 2018-10-5 13:43:11 CST; 15s ago则说明ssh服务已经启动成功</p>\n<h3 id=\"4-卸载ssh服务\">4.卸载ssh服务<a href=\"2018/10/05/linux-ssh-addToGithub-md#4-卸载ssh服务\"></a></h3><p>和安装对应，我们可以使用<br><code>sudo yum remove sshd</code>和<code>sudo apt-get -purge remove sshd</code><br>来卸载ssh服务</p>\n<h1 id=\"三-解决问题-Permission-denied\">三.解决问题(Permission denied)<a href=\"2018/10/05/linux-ssh-addToGithub-md#三-解决问题-Permission-denied\"></a></h1><p>因为误通过sudo命令生成ssh密钥，导致ssh密钥写入了/root系统文件，而引发后来一系列问题<br>丢失了截图，在一次试错后：<br><img src=\"https://www.chenqaq.com/assets/images/linux-ssh-error01.png\" alt=\"请告诉我你的身份\"><br>其实我安装git后已经设置了身份的，通过<code>git config --list</code>查看<br><img src=\"https://www.chenqaq.com/assets/images/linux-ssh-user01.png\" alt=\"git user config\"><br>于是我很自然的先搁置这个问题，下面是Permission denied的报错：<br><img src=\"https://www.chenqaq.com/assets/images/linux-ssh-error02.png\" alt=\"Permission denied\"><br>发现是权限问题，于是我反复检查，才发现自己误用了sudo命令，将ssh密钥写入了系统盘/root，导致权限不足，无法与远程建立连接。<br><img src=\"https://www.chenqaq.com/assets/images/linux-ssh01.png\" alt=\"误用sudo生成ssh密钥\"></p>\n","prev":{"title":"web安全-浅谈xss攻防（一）","link":"2018/10/09/xss-attack-defense-md"},"next":{"title":"requestAnimationFrame优化web动画","link":"2018/05/15/js-requestAnimationFrame-md"},"plink":"//litten.me/2018/10/05/linux-ssh-addToGithub-md/","toc":[{"title":"一.关于ssh密钥","id":"一-关于ssh密钥","index":"1"},{"title":"二.关于ssh服务","id":"二-关于ssh服务","index":"2"},{"title":"三.解决问题(Permission denied)","id":"三-解决问题-Permission-denied","index":"3"}],"copyright":{"custom":"自由转载-非商用-禁止演绎-保持署名（CC BY-NC-ND 4.0）"}}